<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eazy Hosting - ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Prompt', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f4f7f9;
            color: #333;
            line-height: 1.6;
        }

        /* Navigation Bar */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background-color: #2c3e50;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .logo {
            font-size: 1.6em;
            font-weight: bold;
        }

        .navbar a {
            color: white;
            text-decoration: none;
            margin-left: 25px;
            padding: 8px 12px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }

        .navbar a:hover {
            background-color: #34495e;
        }

        /* Main Container */
        .main-content {
            max-width: 800px;
            margin: 30px auto;
            padding: 30px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        h2 {
            color: #007bff;
            margin-bottom: 25px;
            font-weight: 600;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        /* Resource Summary Box */
        .resource-box {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-bottom: 30px;
        }

        .resource-box h3 {
            color: #e67e22; /* ‡∏™‡∏µ‡∏™‡πâ‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ô‡πâ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç */
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .resource-list {
            list-style: none;
            display: flex;
            justify-content: space-around;
        }

        .resource-list li {
            font-size: 1.1em;
            font-weight: bold;
            color: #2c3e50;
        }

        /* Form Styling */
        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 1em;
        }

        /* Input Field Style */
        .form-group input[type="text"] {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            width: 100%; /* ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡πá‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á */
            max-width: 400px; /* ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.05);
            transition: border-color 0.3s;
        }

        .form-group input[type="text"]:focus {
            border-color: #007bff;
            outline: none;
        }

        /* OS Selection Grid */
        .os-selection {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .os-card {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .os-card:hover {
            border-color: #3498db;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }

        /* Radio Button Hack (‡∏ã‡πà‡∏≠‡∏ô Radio ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ CSS ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£) */
        .os-input {
            display: none;
        }

        .os-input:checked + .os-card {
            border-color: #2ecc71;
            box-shadow: 0 0 10px rgba(46, 204, 113, 0.5);
            background-color: #f0fff0;
        }

        .os-icon {
            font-size: 3em;
            margin-bottom: 10px;
            color: #3498db;
        }

        .os-card p {
            font-weight: 600;
        }

        /* Submit Button */
        .create-btn {
            width: 100%;
            padding: 15px;
            background-color: #2ecc71;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            margin-top: 30px;
            transition: background-color 0.3s;
        }

        .create-btn:hover {
            background-color: #27ae60;
        }

        /* Checkbox Agreement */
        .agreement-group {
            margin-top: 20px;
            text-align: center;
            font-size: 0.95em;
        }

        .agreement-group label {
            font-weight: normal;
        }

        .agreement-group a {
            color: #3498db;
            text-decoration: none;
        }
    </style>
</head>
<body>

<header class="navbar">
    <div class="logo">Eazy Hosting üöÄ</div>
    <nav>
        <a href="dashboard.html">Dashboard</a>
        <a href="account.html">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</a>
        <a href="index.html">Logout</a>
    </nav>
</header>

<div class="main-content">
    <h2>üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå Free Tier</h2>

    <div class="resource-box">
        <h3>‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö (Free Tier)</h3>
        <ul class="resource-list">
            <li>1 Core CPU</li>
            <li>1 GB RAM</li>
            <li>10 GB SSD Storage</li>
            <li>‡∏≠‡∏≤‡∏¢‡∏∏‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô 30 ‡∏ß‡∏±‡∏ô (‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÑ‡∏î‡πâ)</li>
        </ul>
    </div>

    <form id="createServerForm">
        <div class="form-group">
            <label>1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£ (OS)</label>
            <div class="os-selection">

                <label>
                    <input type="radio" name="os_choice" value="Ubuntu 22.04" class="os-input" required checked>
                    <div class="os-card">
                        <span class="os-icon">üêß</span>
                        <p>Ubuntu 22.04 LTS</p>
                    </div>
                </label>

                <label>
                    <input type="radio" name="os_choice" value="CentOS 8" class="os-input" required>
                    <div class="os-card">
                        <span class="os-icon" style="color: #e74c3c;">üß±</span>
                        <p>CentOS 8 Stream</p>
                    </div>
                </label>

                <label>
                    <input type="radio" name="os_choice" value="Debian 12" class="os-input" required>
                    <div class="os-card">
                        <span class="os-icon" style="color: #f39c12;">‚öôÔ∏è</span>
                        <p>Debian 12</p>
                    </div>
                </label>

                <label>
                    <input type="radio" name="os_choice" value="OpenSUSE 15" class="os-input" required>
                    <div class="os-card">
                        <span class="os-icon" style="color: #2ecc71;">ü¶é</span>
                        <p>OpenSUSE 15</p>
                    </div>
                </label>
            </div>
        </div>

        <hr style="border: 0; height: 1px; background: #ddd; margin: 30px 0;">

        <div class="form-group">
            <label for="server_name">2. ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡πÉ‡∏ô Dashboard)</label>
            <input type="text" id="server_name" name="serverName" placeholder="‡πÄ‡∏ä‡πà‡∏ô: My-Web-Project" required>
            <small style="display: block; margin-top: 5px; color: #777;">* ‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</small>
        </div>

        <div class="agreement-group">
            <input type="checkbox" id="agree" required>
            <label for="agree">‡∏â‡∏±‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö <a href="#">‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Free Tier</a></label>
        </div>

        <button type="submit" class="create-btn">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå
        </button>

        <p style="text-align: center; margin-top: 15px; color: #e74c3c;">* ‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡∏•‡∏≤ 2-5 ‡∏ô‡∏≤‡∏ó‡∏µ</p>

    </form>
</div>

<script>
    // **‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ CSRF Token ‡∏à‡∏≤‡∏Å Meta Tag**
    function getCsrfToken() {
        const tokenMeta = document.querySelector("meta[name='_csrf']");
        const headerMeta = document.querySelector("meta[name='_csrf_header']");

        if (tokenMeta && headerMeta) {
            return {
                name: headerMeta.content,
                value: tokenMeta.content
            };
        }
        return null;
    }

    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('createServerForm'); // ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢ ID
        const createBtn = document.querySelector('.create-btn');

        form.addEventListener('submit', function(event) {
            event.preventDefault(); // ‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏°

            // 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á
            if (!document.getElementById('agree').checked) {
                alert('‡πÇ‡∏õ‡∏£‡∏î‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏ï‡∏Å‡∏•‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Free Tier');
                return;
            }

            // 2. ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON Object
            const formData = new FormData(form);
            const requestData = {};

            // ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏ú‡πà‡∏≤‡∏ô FormData ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á Object ‡∏ó‡∏µ‡πà‡∏°‡∏µ Key/Value ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö DTO (ServerCreationRequest)
            for (const [key, value] of formData.entries()) {
                requestData[key] = value;
            }

            const csrf = getCsrfToken(); // ‡∏î‡∏∂‡∏á CSRF Token

            // ‡∏õ‡∏¥‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
            createBtn.disabled = true;
            createBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...';
            createBtn.style.backgroundColor = '#f39c12';

            const headers = {
                // *** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Content-Type ‡πÄ‡∏õ‡πá‡∏ô application/json ***
                'Content-Type': 'application/json'
            };

            // 3. ‡πÄ‡∏û‡∏¥‡πà‡∏° CSRF Token ‡πÉ‡∏ô Header
            if (csrf) {
                headers[csrf.name] = csrf.value;
            }

            // 4. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á Back-end API (Body ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô JSON String)
            fetch('/api/v1/servers/create', {
                method: 'POST',
                headers: headers,
                // *** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÅ‡∏õ‡∏•‡∏á Object ‡πÄ‡∏õ‡πá‡∏ô JSON String ***
                body: JSON.stringify(requestData)
            })
                .then(response => {
                    const contentType = response.headers.get("content-type");

                    if (contentType && contentType.indexOf("application/json") !== -1) {
                        return response.json().then(data => {
                            if (response.ok) {
                                return data;
                            } else {
                                // ‡πÇ‡∏¢‡∏ô Error ‡∏û‡∏£‡πâ‡∏≠‡∏° message ‡∏à‡∏≤‡∏Å Server
                                throw new Error(data.message || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå');
                            }
                        });
                    } else {
                        // ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ JSON (‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡πá‡∏ô 500 Internal Server Error)
                        throw new Error("API ‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á JSON)");
                    }
                })
                .then(data => {
                    alert(`‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ${data.message}\nIP: ${data.ip_address}\n‡∏£‡∏´‡∏±‡∏™: ${data.server_code}`);
                    // 5. Redirect ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Dashboard ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                    window.location.href = 'dashboard.html';
                })
                .catch(error => {
                    // 6. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Error
                    alert('‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
                    console.error('Server Creation Error:', error);

                    // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°
                    createBtn.disabled = false;
                    createBtn.textContent = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå';
                    createBtn.style.backgroundColor = '#2ecc71';
                });
        });
    });
</script>
</body>
</html>